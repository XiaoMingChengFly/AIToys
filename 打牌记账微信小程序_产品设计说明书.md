# 棋牌记账微信小程序 — 产品需求与技术设计（V1）

## 一、项目名称

Card Ledger Mini Program（棋牌记账小程序）

---

## 二、项目目标

开发一个微信小程序，用于多人牌局记账。

特点：

- 不限制人数
- 不限制牌局规则
- 仅用于记录输赢与转账流水
- 自动计算每个人的正负余额
- 每次牌局保留完整历史记录

---

## 三、核心功能需求

### 1. 牌局管理

#### 创建牌局

用户可以：

- 创建新的牌局
- 输入牌局名称
- 自动记录创建时间

字段：

- 牌局名称
- 创建时间

---

#### 牌局列表

首页展示：

- 所有历史牌局
- 可点击进入牌局详情

显示内容：

- 牌局名称
- 创建时间

---

### 2. 玩家管理

在单个牌局中：

- 添加玩家（仅输入名字）
- 默认余额为 0

玩家显示信息：

- 玩家名称
- 当前余额（正 / 负）

余额需要实时更新。

---

### 3. 记账功能（核心）

支持记录每一笔输赢流水。

用户操作流程：

- 选择付款人
- 选择收款人
- 输入金额
- 选择 + 或 -

系统行为：

- 自动生成一条记账记录
- 自动更新付款人与收款人的余额

示例：

张三 向 李四 转账 +50

---

### 4. 流水记录

每个牌局必须保存完整历史流水。

每条记录包含：

- 时间
- 付款人
- 收款人
- 金额
- 类型（+ / -）

记录按时间顺序展示。

---

### 5. 牌局详情页

页面展示内容：

- 玩家列表
- 每个玩家的当前余额
- 新增记账入口
- 查看流水入口

---

## 四、数据结构设计

### Game（牌局）

```
id: string
name: string
createTime: number
players: Player[]
records: Record[]
```

---

### Player（玩家）

```
id: string
name: string
balance: number
```

---

### Record（流水）

```
id: string
fromPlayerId: string
toPlayerId: string
amount: number
type: string  // + 或 -
time: number
```

---

## 五、技术实现方案（MVP）

### 前端技术

- 微信小程序原生开发
- WXML / WXSS / JavaScript

---

### 数据存储

第一版使用本地存储：

- wx.setStorageSync
- wx.getStorageSync

无需后端服务器。

---

## 六、页面结构设计

### 首页

路径：

```
pages/index/index
```

功能：

- 展示牌局列表
- 创建新牌局

---

### 牌局详情页

路径：

```
pages/game/game
```

功能：

- 玩家列表
- 余额显示
- 添加玩家
- 新增记账

---

### 流水记录页

路径：

```
pages/records/records
```

功能：

- 查看所有记账流水

---

## 七、项目目录结构要求

Codex 需要生成完整微信小程序结构：

```
app.json
app.js
app.wxss

pages/
  index/
  game/
  records/

utils/
  storage.js
```

---

## 八、MVP 必须实现的能力

- 创建牌局
- 添加玩家
- 记账
- 自动计算余额
- 保存历史记录
- 使用本地存储持久化数据

---

## 九、Codex 开发任务要求

Codex 需要：

- 读取本 MD 文档
- 自动生成完整微信小程序项目
- 项目可直接在微信开发者工具中运行
- 使用本地存储保存数据
- 实现清晰、可扩展的代码结构
